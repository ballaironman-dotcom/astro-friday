---
import components from 'virtual:astro-friday-components'
import config from 'virtual:astro-friday-config'
import ThemeToggle from './ThemeToggle.astro'
---

<header class="p-2rem flex gap-1.2rem items-center relative">
  <div class="[&>*]:(translate-y--50%) lg:fixed">
    <components.NavbarBrand />
  </div>

  <i class="flex-1"></i>

  <nav>
    <ul class="gap-1.2rem grid grid-flow-col">
      {Object.entries(config.navigations).map(([key, item]) => {
        if (key === 'theme-toggle') {
          return (<li style={{ order: config.navigations['theme-toggle']!.order }}><ThemeToggle /></li>)
        }
        return (
          <li
            style={{
              order: item.order ?? 0,
              display: item.hidden ? 'none' : undefined,
            }}
          >
            <a
              href={item.link}
              target={item.external ? '_blank' : '_self'}
              class="hoverable-text"
            >
              {
                item.type === 'icon' && item.icon
                ? (
                    <i class={`${item.icon}`}></i>
                  )
                : (
                    <>
                      <span class="lt-md:hidden">{item.label}</span>
                      {item.icon && <i class={`${item.icon} md:hidden`}></i>}
                    </>
                  )
              }
            </a>
          </li>
        )
      })}
    </ul>
  </nav>

  <button
    title="Scroll to top"
    class:list={[
      'scroll-to-top rounded-full grid size-10 transition duration-300 bottom-3 right-3 place-content-center fixed z-100 hover-bg-hex-8883 print:hidden',
      // due to the animation property has higher priority than the class property
      // so we change the color between non-hover and hover state to achieve the hover effect
      'color-gray-700/30 dark:color-gray-200/30 hover:color-gray-700 dark:hover:color-gray-200',
    ]}
    onclick="window.scrollTo({ top: 0, behavior: 'smooth' })"
  >
    <div class="i-lucide:arrow-up" />
  </button>
</header>

<style>
  @keyframes fade-in-out {
    from {
      opacity: 0 ;
      cursor: default;
    }
    to {
      opacity: 1;
    }
  }

  .scroll-to-top {
      animation: fade-in-out linear forwards;
      animation-timeline: scroll();
      animation-range: 0vh 30vh;
  }
</style>
